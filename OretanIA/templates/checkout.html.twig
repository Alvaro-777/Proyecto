{% extends 'base.html.twig' %}
{% block title %}Confirmar Compra{% endblock %}
{% block body %}
    <h1>Confirmar tu compra</h1>
    <div style="border: 1px solid #ddd; padding: 20px; margin: 20px; max-width: 500px;">
        <h2>Resumen del pedido</h2>
        <p><strong>Plan:</strong>
            {% if planId == 1 %}
                Básico
            {% elseif planId == 2 %}
                Pro (+200 bonus)
            {% else %}
                Premium (+500 bonus)
            {% endif %}
        </p>
        <p><strong>Créditos:</strong> {{ plan.creditos }}</p>
        <p><strong>Precio:</strong> {{ plan.precio | number_format(2, '.') }} €</p>

        {% if aplicaDescuento %}
            <p style="color: green;"><strong>¡10% de descuento en tu primera compra!</strong></p>
        {% endif %}

        <p><strong>Total a pagar:</strong> <span style="font-size: 1.2em; color: red;">{{ precioFinal }} €</span></p>
        <hr>
        <h3>Método de pago (simulado)</h3>
        <form method="post">
            <p>
                <label for="tarjeta">Número de tarjeta:</label><br>
                <input type="text" id="tarjeta" name="tarjeta" placeholder="1234 5678 9012 3456" required>
            </p>
            <p>
                <label for="fecha">Fecha de expiración:</label><br>
                <input type="text" id="fecha" name="fecha" placeholder="MM/AA" pattern="^(0[1-9]|1[0-2])\/\d{2}$" required>
            </p>
            <p>
                <label for="cvv">CVV:</label><br>
                <input type="text" id="cvv" name="cvv" placeholder="123" pattern="[0-9]{3}" maxlength="3" title="Ingrese un CVV válido de 3 dígitos" required>
            </p>

            <button type="submit" style="background-color: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer;">
                Confirmar pago
            </button>

            <a href="{{ path('pago_planes') }}">
                Volver a planes
            </a>
        </form>
    </div>
    <script src="{{ asset('script/validacion-tarjeta.js') }}"></script>
{% endblock %}